if (window.consoleToggle) {
	var console = {};

	console.log = function () {};
} else {
	var iframe = document.createElement("iframe");

	iframe.style.display = "none";

	document.body.appendChild(iframe);

	console = iframe.contentWindow.console;

	window.console = console;
}

$(document).ready(function () {
	const urlSearchParams = new URLSearchParams(window.location.search);
	const params = Object.fromEntries(urlSearchParams.entries());
	let data = { workOrderId: params.workOrderID };

	const getList = () => {
		let formData = new FormData();

		let session_id = "";

		let action = "getCheckList";

		let chsm = "upStrongCheckListApi"; // api文件相關

		chsm = $.md5(session_id + action + chsm);

		formData.append("data", JSON.stringify(data));

		formData.append("session_id", session_id);

		formData.append("action", action);

		formData.append("chsm", chsm);

		$.ajax({
			url: `${window.apiUrl}${window.apicheckList}`,

			type: "POST",

			data: formData,

			processData: false,

			contentType: false,

			success: function (res) {
				localStorage.setItem("listData", JSON.stringify(res.returnData));

				$(".card-box").html("");
				if (res.returnCode) {
					$(res.returnData.item).each(function (idx, e) {
						console.log(e);

						$(".card-box").append(`

                            <div class="card" data-cardidx="${idx}">

                            <div class="title-box">

                                <div class="icon-box">

                                ${
																	idx == 0
																		? `<svg width="14" height="22" viewBox="0 0 14 22" fill="none" xmlns="http://www.w3.org/2000/svg">

                                        <path

                                        d="M9.84023 2.01549H8.38375C8.38375 1.18886 7.7146 0.5 6.86829 0.5C6.04166 0.5 5.35277 1.16918 5.35277 2.01549H3.89635C3.48303 2.01549 3.14844 2.35009 3.14844 2.7634V4.37728C3.14844 4.79059 3.48303 5.12519 3.89635 5.12519H9.84023C10.2535 5.12519 10.5881 4.79059 10.5881 4.37728V2.7634C10.5881 2.35009 10.2535 2.01549 9.84023 2.01549Z"

                                        fill="white" />

                                        <path

                                        d="M12.1829 3.47266H11.7105V4.37799C11.7105 5.42112 10.8642 6.26744 9.8211 6.26744H3.87722C2.83409 6.26744 1.9878 5.42112 1.9878 4.37799V3.47266H1.51546C0.688834 3.47266 0 4.14181 0 4.98812V19.9855C0 20.8121 0.669153 21.501 1.51546 21.501H12.1829C13.0095 21.501 13.6984 20.8318 13.6984 19.9855V4.98812C13.6984 4.14181 13.0292 3.47266 12.1829 3.47266ZM3.08997 16.7971C2.71602 16.7971 2.4208 16.5019 2.4208 16.1279C2.4208 15.754 2.71602 15.4587 3.08997 15.4587C3.46392 15.4587 3.75913 15.754 3.75913 16.1279C3.73945 16.5019 3.44423 16.7971 3.08997 16.7971ZM3.08997 14.2778C2.71602 14.2778 2.4208 13.9826 2.4208 13.6087C2.4208 13.2347 2.71602 12.9395 3.08997 12.9395C3.46392 12.9395 3.75913 13.2347 3.75913 13.6087C3.73945 13.9826 3.44423 14.2778 3.08997 14.2778ZM3.08997 11.7389C2.71602 11.7389 2.4208 11.4437 2.4208 11.0698C2.4208 10.6958 2.71602 10.4006 3.08997 10.4006C3.46392 10.4006 3.75913 10.6958 3.75913 11.0698C3.73945 11.4437 3.44423 11.7389 3.08997 11.7389ZM10.6281 16.7971H5.88478C5.51083 16.7971 5.21561 16.5019 5.21561 16.1279C5.21561 15.754 5.51083 15.4587 5.88478 15.4587H10.6281C11.002 15.4587 11.2972 15.754 11.2972 16.1279C11.2972 16.5019 11.002 16.7971 10.6281 16.7971ZM10.6281 14.2778H5.88478C5.51083 14.2778 5.21561 13.9826 5.21561 13.6087C5.21561 13.2347 5.51083 12.9395 5.88478 12.9395H10.6281C11.002 12.9395 11.2972 13.2347 11.2972 13.6087C11.2972 13.9826 11.002 14.2778 10.6281 14.2778ZM11.2972 11.0894C11.2972 11.4634 11.002 11.7586 10.6281 11.7586H5.88478C5.51083 11.7586 5.21561 11.4634 5.21561 11.0894C5.21561 10.7155 5.51083 10.4203 5.88478 10.4203H10.6281C11.002 10.4203 11.2972 10.7155 11.2972 11.0894Z"

                                        fill="white" />

                                    </svg>`
																		: ""
																}

                                ${
																	idx == 1
																		? `<svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">

                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M8.09375 2.625C4.59025 2.625 1.75 5.46525 1.75 8.96875C1.75 16.8438 12.25 18.375 12.25 18.375V15.3125H12.9062C16.4097 15.3125 19.25 12.4722 19.25 8.96875C19.25 5.46525 16.4097 2.625 12.9062 2.625H8.09375ZM10.5 10.2812C10.7901 10.2812 11.0683 10.166 11.2734 9.9609C11.4785 9.75578 11.5938 9.47758 11.5938 9.1875C11.5938 8.89742 11.4785 8.61922 11.2734 8.4141C11.0683 8.20898 10.7901 8.09375 10.5 8.09375C10.2099 8.09375 9.93172 8.20898 9.7266 8.4141C9.52148 8.61922 9.40625 8.89742 9.40625 9.1875C9.40625 9.47758 9.52148 9.75578 9.7266 9.9609C9.93172 10.166 10.2099 10.2812 10.5 10.2812ZM15.0938 9.1875C15.0938 9.47758 14.9785 9.75578 14.7734 9.9609C14.5683 10.166 14.2901 10.2812 14 10.2812C13.7099 10.2812 13.4317 10.166 13.2266 9.9609C13.0215 9.75578 12.9062 9.47758 12.9062 9.1875C12.9062 8.89742 13.0215 8.61922 13.2266 8.4141C13.4317 8.20898 13.7099 8.09375 14 8.09375C14.2901 8.09375 14.5683 8.20898 14.7734 8.4141C14.9785 8.61922 15.0938 8.89742 15.0938 9.1875ZM7 10.2812C7.29008 10.2812 7.56828 10.166 7.7734 9.9609C7.97852 9.75578 8.09375 9.47758 8.09375 9.1875C8.09375 8.89742 7.97852 8.61922 7.7734 8.4141C7.56828 8.20898 7.29008 8.09375 7 8.09375C6.70992 8.09375 6.43172 8.20898 6.2266 8.4141C6.02148 8.61922 5.90625 8.89742 5.90625 9.1875C5.90625 9.47758 6.02148 9.75578 6.2266 9.9609C6.43172 10.166 6.70992 10.2812 7 10.2812Z" fill="white"/>

                                    </svg>

                                    `
																		: ""
																}

                                ${
																	idx == 2
																		? `<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">

                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M18.8216 3.79044C18.8491 3.84091 18.8664 3.8963 18.8725 3.95346C18.8786 4.01061 18.8734 4.06841 18.8571 4.12354C18.8409 4.17868 18.8139 4.23007 18.7778 4.27478C18.7417 4.31949 18.6971 4.35665 18.6466 4.38413L16.2404 5.69663C16.1738 5.73288 16.0988 5.75119 16.023 5.74977C15.9472 5.74834 15.873 5.72722 15.8078 5.68848C15.7426 5.64974 15.6886 5.59472 15.6511 5.5288C15.6135 5.46289 15.5938 5.38835 15.5937 5.3125V4.73719L13.8346 5.69663C13.7327 5.7522 13.6129 5.76504 13.5016 5.7323C13.3902 5.69956 13.2965 5.62394 13.2409 5.52206C13.1853 5.42019 13.1725 5.3004 13.2052 5.18907C13.2379 5.07773 13.3136 4.98395 13.4154 4.92837L15.8217 3.61588C15.8883 3.57951 15.9633 3.56112 16.0392 3.56249C16.1151 3.56387 16.1893 3.58496 16.2546 3.62372C16.3199 3.66247 16.3739 3.71753 16.4115 3.78351C16.449 3.84948 16.4688 3.92409 16.4687 4V4.57531L18.2279 3.61588C18.2784 3.58836 18.3338 3.57106 18.391 3.56497C18.4481 3.55888 18.5059 3.5641 18.561 3.58036C18.6162 3.59661 18.6676 3.62356 18.7123 3.65969C18.757 3.69581 18.7941 3.74039 18.8216 3.79087V3.79044ZM13.667 15.1882C13.7166 15.0833 13.8058 15.0024 13.9149 14.9633C14.0241 14.9241 14.1444 14.93 14.2493 14.9795L16.5886 16.0846C16.6574 16.1171 16.7166 16.1669 16.7603 16.2292C16.8039 16.2915 16.8306 16.3642 16.8376 16.4399C16.8446 16.5157 16.8318 16.592 16.8003 16.6612C16.7688 16.7305 16.7199 16.7904 16.6582 16.8349L16.0798 17.2532L17.7493 18.042C17.8517 18.0931 17.93 18.1822 17.9675 18.2903C18.0049 18.3984 17.9985 18.5169 17.9497 18.6204C17.9008 18.7238 17.8133 18.804 17.706 18.8438C17.5988 18.8835 17.4802 18.8796 17.3757 18.833L15.0364 17.7279C14.9676 17.6954 14.9084 17.6456 14.8647 17.5833C14.8211 17.521 14.7944 17.4483 14.7874 17.3726C14.7804 17.2968 14.7932 17.2205 14.8247 17.1513C14.8562 17.082 14.9051 17.0221 14.9668 16.9776L15.5452 16.5593L13.8757 15.7705C13.7708 15.7209 13.6899 15.6317 13.6508 15.5226C13.6116 15.4134 13.6175 15.2931 13.667 15.1882ZM16.9137 9.78156C16.977 9.83153 17.0252 9.89802 17.0531 9.97368C17.0809 10.0493 17.0874 10.1312 17.0716 10.2103L16.8909 11.1194L18.2546 10.4925C18.3068 10.4685 18.3632 10.455 18.4206 10.4528C18.4781 10.4506 18.5353 10.4597 18.5892 10.4796C18.6431 10.4995 18.6926 10.5299 18.7347 10.5689C18.7769 10.6079 18.811 10.6549 18.835 10.7071C18.859 10.7593 18.8725 10.8157 18.8747 10.8731C18.8769 10.9305 18.8678 10.9878 18.8479 11.0417C18.8279 11.0956 18.7976 11.145 18.7586 11.1872C18.7195 11.2294 18.6726 11.2634 18.6204 11.2874L16.4775 12.2731C16.4042 12.3069 16.323 12.3197 16.2429 12.3102C16.1627 12.3007 16.0868 12.2692 16.0235 12.2192C15.9601 12.1692 15.9118 12.1027 15.8839 12.0269C15.856 11.9512 15.8496 11.8693 15.8654 11.7901L16.0461 10.8806L14.682 11.5071C14.5772 11.5518 14.459 11.5538 14.3527 11.5127C14.2464 11.4717 14.1603 11.3907 14.1128 11.2871C14.0652 11.1836 14.06 11.0655 14.0981 10.9581C14.1363 10.8507 14.2149 10.7625 14.3171 10.7121L16.4596 9.72775C16.5328 9.69411 16.614 9.68137 16.694 9.69094C16.7741 9.70052 16.85 9.73203 16.9132 9.782L16.9137 9.78156ZM10.2125 3.125V5.54831C10.2125 6.23694 9.79906 6.69106 9.42062 6.91769C9.11131 7.10319 8.77619 7.17581 8.57844 7.21212C8.368 7.2515 8.13569 7.27775 7.9445 7.30006L7.91606 7.30356C7.70169 7.3285 7.51181 7.35081 7.32762 7.38231C6.93256 7.45012 6.74662 7.53325 6.67137 7.59056C6.66501 7.59535 6.65914 7.60077 6.65387 7.60675C6.65387 7.60675 6.65256 7.60806 6.65125 7.61112C6.64335 7.62989 6.6379 7.64959 6.63506 7.66975C6.65256 7.67675 6.67225 7.68419 6.69456 7.69162C7.06862 7.81981 7.60106 7.87538 8.37019 7.955L8.51106 7.96987C9.236 8.04556 10.2164 8.15144 11.014 8.50625C11.4384 8.69481 11.8881 8.98531 12.2298 9.44731C12.5833 9.9255 12.75 10.4921 12.75 11.1011C12.75 11.7529 12.5417 12.3597 12.092 12.8371C11.6729 13.2816 11.1444 13.5064 10.6902 13.6307C9.86119 13.8577 8.83612 13.856 8.039 13.8542H7.93575C6.99775 13.8529 6.32706 13.863 5.88125 13.9868C5.83679 13.9987 5.7931 14.0133 5.75044 14.0306C5.75481 14.1771 5.785 14.227 5.78544 14.2283C5.78763 14.2318 5.78981 14.2353 5.79681 14.2414C5.81424 14.2572 5.83348 14.2709 5.85412 14.2821C6.02825 14.3814 6.37256 14.4633 6.95487 14.4934C7.21912 14.5066 7.48731 14.5088 7.77212 14.5109H7.79619C8.07312 14.5131 8.38856 14.5153 8.67206 14.5372C8.92581 14.5564 9.31956 14.6002 9.68181 14.7691C9.87912 14.8609 10.1307 15.0189 10.3337 15.2901C10.5502 15.5802 10.65 15.9175 10.65 16.25V18.875H8.025V17.1381C7.94261 17.1371 7.86021 17.1364 7.77781 17.1359H7.73581C7.46456 17.1338 7.14387 17.1316 6.82012 17.1149C6.17744 17.0817 5.29675 16.9868 4.55212 16.5615C4.15444 16.334 3.77906 16.0041 3.51044 15.5378C3.24269 15.0718 3.125 14.5468 3.125 13.9947C3.125 13.3428 3.33194 12.7356 3.7795 12.2569C4.19775 11.8098 4.72537 11.5827 5.18125 11.4563C6.01512 11.2257 7.04544 11.2275 7.84562 11.2288H7.93925C8.87812 11.2301 9.54969 11.2209 9.99725 11.0984C10.0519 11.0836 10.0935 11.0691 10.1237 11.0573C10.1228 11.0396 10.1202 11.022 10.1158 11.0048C10.1036 10.9921 10.0589 10.9541 9.94694 10.9042C9.59606 10.748 9.04525 10.6644 8.23894 10.5804C8.16723 10.5727 8.09548 10.5654 8.02369 10.5586C7.36219 10.4912 6.52044 10.4063 5.8445 10.1749C5.44769 10.0388 4.98131 9.81437 4.609 9.40925C4.20563 8.97 4 8.41306 4 7.80231C4 6.814 4.39419 6.02869 5.0745 5.50719C5.67213 5.04869 6.38306 4.88025 6.88487 4.7945C7.11817 4.75605 7.35246 4.72396 7.5875 4.69825V3.125H10.2125ZM10.1119 10.9956C10.1119 10.9956 10.1136 10.9969 10.1149 11.0022L10.1119 10.9952V10.9956Z" fill="white"/>

                                    </svg>

                                    `
																		: ""
																}

                                ${
																	idx == 3
																		? `<svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">

                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M8.3125 1.75C8.42853 1.75 8.53981 1.79609 8.62186 1.87814C8.70391 1.96019 8.75 2.07147 8.75 2.1875V5.83756C8.75001 6.06743 8.70473 6.29505 8.61675 6.50742C8.52877 6.71978 8.39982 6.91273 8.23725 7.07525L8.01719 7.29531C7.77552 7.53671 7.62768 7.85625 7.60012 8.19672C7.57257 8.53719 7.6671 8.87634 7.8668 9.15346C8.06649 9.43059 8.35831 9.62758 8.69 9.70917C9.0217 9.79076 9.3716 9.75162 9.67706 9.59875L9.78337 9.54625C10.0059 9.43501 10.2512 9.3771 10.5 9.3771C10.7488 9.3771 10.9941 9.43501 11.2166 9.54625L11.3229 9.59875C11.6284 9.75162 11.9783 9.79076 12.31 9.70917C12.6417 9.62758 12.9335 9.43059 13.1332 9.15346C13.3329 8.87634 13.4274 8.53719 13.3999 8.19672C13.3723 7.85625 13.2245 7.53671 12.9828 7.29531L12.7628 7.07525C12.6002 6.91273 12.4712 6.71978 12.3832 6.50742C12.2953 6.29505 12.25 6.06743 12.25 5.83756V2.1875C12.25 2.07147 12.2961 1.96019 12.3781 1.87814C12.4602 1.79609 12.5715 1.75 12.6875 1.75C12.8035 1.75 12.9148 1.79609 12.9969 1.87814C13.0789 1.96019 13.125 2.07147 13.125 2.1875V3.073C16.1836 4.15406 18.375 7.07131 18.375 10.5C18.375 13.9287 16.1836 16.8459 13.125 17.927V18.8125C13.125 18.9285 13.0789 19.0398 12.9969 19.1219C12.9148 19.2039 12.8035 19.25 12.6875 19.25C12.5715 19.25 12.4602 19.2039 12.3781 19.1219C12.2961 19.0398 12.25 18.9285 12.25 18.8125V15.1624C12.25 14.9326 12.2953 14.705 12.3832 14.4926C12.4712 14.2802 12.6002 14.0873 12.7628 13.9248L12.9828 13.7047C13.2245 13.4633 13.3723 13.1437 13.3999 12.8033C13.4274 12.4628 13.3329 12.1237 13.1332 11.8465C12.9335 11.5694 12.6417 11.3724 12.31 11.2908C11.9783 11.2092 11.6284 11.2484 11.3229 11.4013L11.2166 11.4538C10.9941 11.565 10.7488 11.6229 10.5 11.6229C10.2512 11.6229 10.0059 11.565 9.78337 11.4538L9.67706 11.4013C9.3716 11.2484 9.0217 11.2092 8.69 11.2908C8.35831 11.3724 8.06649 11.5694 7.8668 11.8465C7.6671 12.1237 7.57257 12.4628 7.60012 12.8033C7.62768 13.1437 7.77552 13.4633 8.01719 13.7047L8.23725 13.9248C8.39982 14.0873 8.52877 14.2802 8.61675 14.4926C8.70473 14.705 8.75001 14.9326 8.75 15.1624V18.8125C8.75 18.9285 8.70391 19.0398 8.62186 19.1219C8.53981 19.2039 8.42853 19.25 8.3125 19.25C8.19647 19.25 8.08519 19.2039 8.00314 19.1219C7.92109 19.0398 7.875 18.9285 7.875 18.8125V17.927C4.81644 16.8459 2.625 13.9287 2.625 10.5C2.625 7.07131 4.81644 4.15406 7.875 3.073V2.1875C7.875 2.07147 7.92109 1.96019 8.00314 1.87814C8.08519 1.79609 8.19647 1.75 8.3125 1.75Z" fill="white"/>

                                    </svg>

                                    `
																		: ""
																}

                                ${
																	idx == 4
																		? `<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">

                                    <path d="M12.3037 5.29492C13.2662 5.29492 14.0537 4.50742 14.0537 3.54492C14.0537 2.58242 13.2662 1.79492 12.3037 1.79492C11.3412 1.79492 10.5537 2.58242 10.5537 3.54492C10.5537 4.50742 11.3412 5.29492 12.3037 5.29492ZM9.52997 15.7949L10.0287 13.6074L11.8662 15.3574V19.7324C11.8662 20.2137 12.26 20.6074 12.7412 20.6074C13.2225 20.6074 13.6162 20.2137 13.6162 19.7324V14.7974C13.6162 14.3162 13.4237 13.8612 13.0737 13.5287L11.7787 12.2949L12.3037 9.66992C13.2898 10.7972 14.6396 11.5433 16.1187 11.7787C16.6437 11.8574 17.1162 11.4374 17.1162 10.9037C17.1162 10.4749 16.8012 10.1162 16.3725 10.0462C15.0425 9.82742 13.94 9.03992 13.3537 8.00742L12.4787 6.60742C12.1287 6.08242 11.6037 5.73242 10.9912 5.73242C10.7287 5.73242 10.5537 5.81992 10.2912 5.81992L6.80872 7.28992C6.49172 7.42542 6.22153 7.65109 6.03174 7.93889C5.84195 8.22669 5.74092 8.56392 5.74122 8.90867V10.9824C5.74122 11.4637 6.13497 11.8574 6.61622 11.8574C7.09747 11.8574 7.49122 11.4637 7.49122 10.9824V8.88242L9.06622 8.26992L7.66622 15.3574L4.23622 14.6574C3.76372 14.5612 3.29997 14.8674 3.20372 15.3399V15.3749C3.10747 15.8474 3.41372 16.3112 3.88622 16.4074L7.48247 17.1249C7.92977 17.2137 8.39406 17.1244 8.77648 16.876C9.1589 16.6276 9.42925 16.2397 9.52997 15.7949Z" fill="white"/>

                                    </svg>

                                    `
																		: ""
																}

                                ${
																	idx == 5
																		? `<svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">

                                    <path d="M7 9.04837V10.9681C6.536 11.237 6.14 11.6089 5.84259 12.0551C5.54517 12.5013 5.3543 13.01 5.28472 13.5417C5.21513 14.0734 5.2687 14.614 5.44127 15.1218C5.61384 15.6295 5.90081 16.0908 6.28001 16.47C6.6592 16.8492 7.12048 17.1362 7.62822 17.3087C8.13596 17.4813 8.67657 17.5349 9.2083 17.4653C9.74003 17.3957 10.2487 17.2048 10.6949 16.9074C11.1411 16.61 11.513 16.214 11.7819 15.75H13.7007C13.2866 16.9163 12.4739 17.8988 11.406 18.5243C10.3381 19.1498 9.08355 19.3781 7.86375 19.1688C6.64395 18.9595 5.53724 18.3262 4.73886 17.3805C3.94048 16.4349 3.50173 15.2376 3.5 14C3.5 12.9141 3.83655 11.8549 4.46333 10.9681C5.09012 10.0814 5.97633 9.4107 7 9.04837ZM10.5 14.875C9.80381 14.875 9.13613 14.5984 8.64384 14.1062C8.15156 13.6139 7.875 12.9462 7.875 12.25V8.75C7.875 8.05381 8.15156 7.38613 8.64384 6.89384C9.13613 6.40156 9.80381 6.125 10.5 6.125C11.1962 6.125 11.8639 6.40156 12.3562 6.89384C12.8484 7.38613 13.125 8.05381 13.125 8.75V13.125H14.3797C14.658 13.1251 14.9322 13.1914 15.1796 13.3187C15.427 13.4459 15.6406 13.6303 15.8025 13.8565L15.8804 13.9746L18.2499 17.9252L16.7501 18.8247L14.3789 14.875H10.5ZM10.5 1.75C11.0802 1.75 11.6366 1.98047 12.0468 2.3907C12.457 2.80094 12.6875 3.35734 12.6875 3.9375C12.6875 4.51766 12.457 5.07406 12.0468 5.4843C11.6366 5.89453 11.0802 6.125 10.5 6.125C9.91984 6.125 9.36344 5.89453 8.9532 5.4843C8.54297 5.07406 8.3125 4.51766 8.3125 3.9375C8.3125 3.35734 8.54297 2.80094 8.9532 2.3907C9.36344 1.98047 9.91984 1.75 10.5 1.75Z" fill="white"/>

                                    </svg>

                                    `
																		: ""
																}

                                </div>

                                <span class="title ms-2">${e.name}</span>

                                <div class="percent">

                                <div class="g-container">

                                    <div class="g-progress" style="--progress: 0%" "></div>

                                    <div class="g-circle"></div>

                                    <span class="text">0%</span>

                                </div>

                                </div>

                            </div>

                            <div class="list-box ${e.sort}">

                            </div>

                            </div>

                        `);

						$(e.item).each(function (idxx, ee) {
							$(`.list-box.${e.sort}`).append(`

                <div class="list" data-listidx=${idxx} data-listurl=${idx}>

                  <img src="./images/uncheck.png">

                  <span class="index">${ee.sort}</span>

                  <span class="text">${ee.name}</span>

                  <span class="arrow">

                    <img src="./images/list-arrow.png">

                  </span>

                </div>

              `);
						});
					});

					getCheckListRecord();
				}

				$(".card .list").on("click", (e) => {
					console.log(e);

					if ($($(e)[0].target).attr("data-listidx") == 2 && $($(e)[0].target).attr("data-listurl") == 2) {
						window.location.href = `./question/question_a0${
							Number($($(e)[0].target).attr("data-listurl")) + 1
						}.html?step=2-02&bigstep=${Number($($(e)[0].target).attr("data-listurl"))}`;
					} else {
						window.location.href = `./question/question_a0${
							Number($($(e)[0].target).attr("data-listurl")) + 1
						}.html?step=${Number($($(e)[0].target).attr("data-listidx")) + 1}&bigstep=${Number(
							$($(e)[0].target).attr("data-listurl")
						)}`;
					}
				});
			},

			error: function () {
				$("#error").text("An error occurred. Please try again later.");
			},
		});
	};

	// 加入 getNextPage 函數
	function getNextPage(currentUrl) {
		const urlParts = currentUrl.split("?");
		const path = urlParts[0];
		const params = new URLSearchParams(urlParts[1]);

		const currentQuestionMatch = path.match(/question_a(\d+)\.html/);
		if (!currentQuestionMatch) return null;
		const currentNum = parseInt(currentQuestionMatch[1]);
		const nextNum = currentNum + 1;
		const nextQuestion = `question_a${nextNum.toString().padStart(2, "0")}.html`;
		const nextPath = path.replace(/question_a\d+\.html/, nextQuestion);

		params.set("step", "1");
		const currentBigStep = parseInt(params.get("bigstep"));
		params.set("bigstep", currentBigStep + 1);

		return `${nextPath}?${params.toString()}`;
	}
	$(".card .list").on("click", (e) => {
		const $target = $(e.currentTarget);
		const listIdx = Number($target.attr("data-listidx"));
		const listUrl = Number($target.attr("data-listurl"));
		const urlSearchParams = new URLSearchParams(window.location.search);
		const params = Object.fromEntries(urlSearchParams.entries());

		// 調試輸出
		console.log("target element:", $target[0]);
		console.log("data-listidx:", $target.attr("data-listidx"), "parsed:", listIdx);
		console.log("data-listurl:", $target.attr("data-listurl"), "parsed:", listUrl);

		// 檢查是否為 NaN
		if (isNaN(listIdx) || isNaN(listUrl)) {
			console.error("Invalid listIdx or listUrl, cannot proceed with navigation.");
			return;
		}

		// 特殊情況處理
		if (listIdx === 2 && listUrl === 2) {
			window.location.href = `./question/question_a0${listUrl + 1}.html?workOrderID=${
				params.workOrderID
			}&step=4&bigstep=${listUrl}`;
		} else if (listIdx === 3 && listUrl === 2) {
			window.location.href = `./question/question_a0${listUrl + 1}.html?workOrderID=${
				params.workOrderID
			}&step=4-02&bigstep=${listUrl}`;
		} else if (listIdx === 7 && listUrl === 1) {
			window.location.href = `./question/question_a03.html?workOrderID=${params.workOrderID}&step=1&bigstep=2`;
		} else if (listIdx === 8 && listUrl === 1) {
			window.location.href = `./question/question_a03.html?workOrderID=${params.workOrderID}&step=2&bigstep=2`;
		} else if (listIdx === 1 && listUrl === 2) {
			window.location.href = `./question/question_a03.html?workOrderID=${params.workOrderID}&step=3&bigstep=2`;
		} else if (listIdx === 2 && listUrl === 2) {
			window.location.href = `./question/question_a03.html?workOrderID=${params.workOrderID}&step=4&bigstep=2`;
		} else {
			// 使用 getNextPage 處理一般情況
			const currentUrl = window.location.href;
			const nextUrl = getNextPage(currentUrl);
			if (nextUrl) {
				window.location.href = nextUrl;
			} else {
				// 預設跳轉邏輯
				window.location.href = `./question/question_a0${listUrl + 1}.html?workOrderID=${
					params.workOrderID
				}&step=${listIdx}&bigstep=${listUrl}`;
			}
		}
	});

	// $(".card .list").on("click", (e) => {
	// 	let sectionId = $($(e)[0].target).attr("data-listurl");
	// 	// console.log(e);
	// 	// console.log(sectionId);

	// 	if ($($(e)[0].target).attr("data-listidx") == 2 && $($(e)[0].target).attr("data-listurl") == 2) {
	// 		window.location.href = `./question/question_a0${
	// 			Number($($(e)[0].target).attr("data-listurl")) + 1
	// 		}.html?step=2&bigstep=${Number($($(e)[0].target).attr("data-listurl"))}`;
	// 	} else if ($($(e)[0].target).attr("data-listidx") == 3 && $($(e)[0].target).attr("data-listurl") == 2) {
	// 		window.location.href = `./question/question_a0${
	// 			Number($($(e)[0].target).attr("data-listurl")) + 1
	// 		}.html?step=2-02&bigstep=${Number($($(e)[0].target).attr("data-listurl"))}`;
	// 	} else {
	// 		window.location.href = `./question/question_a0${
	// 			Number($($(e)[0].target).attr("data-listurl")) + 1
	// 		}.html?workOrderID=${params.workOrderID}&step=${Number($($(e)[0].target).attr("data-listidx"))}&bigstep=${Number(
	// 			$($(e)[0].target).attr("data-listurl")
	// 		)}`;
	// 	}
	// });

	const getCheckListRecord = () => {
		let formData = new FormData();

		let session_id = sessionStorage.getItem("sessionId");

		let action = "getCheckListRecord";

		let chsm = "upStrongCheckListApi"; // api文件相關

		chsm = $.md5(session_id + action + chsm);

		formData.append("session_id", session_id);

		formData.append("action", action);

		formData.append("chsm", chsm);

		formData.append("data", JSON.stringify(data));

		$.ajax({
			url: `${window.apiUrl}${window.apicheckList}`,

			type: "POST",

			data: formData,

			processData: false,

			contentType: false,

			success: function (res) {
				if (res.returnCode) {
					handleResponse(res);

					$(res.returnData.item).each((idx, e) => {
						$(`[data-cardidx=${idx + 1}] .g-container .text`).html(`${e.percent * 100}%`);

						$(`[data-cardidx=${idx + 1}] .g-progress`).css(
							"--progress",

							`${e.percent * 100}%`
						);

						$(e.item).each((idxx, ee) => {
							if (ee.if_complete) {
								$($(`[data-cardidx=${idx + 1}] [data-listidx=${idxx + 1}] img`)[0]).attr("src", "./images/checked.png");
								$($(`[data-cardidx=${3}] [data-listidx=${7}] img`)[0]).attr("src", "./images/checked.png");
								$($(`[data-cardidx=${3}] [data-listidx=${8}] img`)[0]).attr("src", "./images/checked.png");
							}
						});
					});
				}
			},
		});
	};

	$(".origin").on("click", function (e) {
		e.preventDefault(); // 防止 <a> 的預設跳轉行為

		// 確保 `params` 存在
		if (params && params.workOrderID) {
			window.location.href = `../../pages/AssessmentPage/question/index.html?workOrderID=${params.workOrderID}`;
		} else {
			console.warn("缺少 workOrderID，無法跳轉");
		}
	});

	getCheckListRecord();
});
